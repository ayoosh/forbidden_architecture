# Set Stack Pointer ;
LLW R1 0xFFFF ; # Start of Assembly converted code. Anything above this should be NPU Config code
LHW R1 0x020F ;

# SPART Registers
LLW R2 0x0000 ; # SPART Data Address
LHW R2 0x0800 ; # SPART Data Address
LLW R3 0x0001 ; # SPART Status Address
LHW R3 0x0800 ; # SPART Status Address
LLW R4 0x0002 ; # SPART Status RX Mask / 2
LLW R5 0x0001 ; # SPART Status TX Mask / 1



IK2J_RX_INPUT_1 LOAD R31 R3 0x00 ;
AND R0 R31 R4 ;
B EQ IK2J_RX_INPUT_1 ;
LOAD R7 R2 0x0000 ; # Input 1

ADD R0 R0 R0 ; # NOPS
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ; # NOPS

IK2J_RX_INPUT_2 LOAD R31 R3 0x00 ;
AND R0 R31 R4 ;
B EQ IK2J_RX_INPUT_2 ;
LOAD R8 R2 0x0000 ; # Input 2

ADD R0 R0 R0 ; # NOPS
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ; # NOPS

ENQD0 R7 ;
ENQD0 R8 ;

ADD R0 R0 R0 ; # NOPS
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ; # NOPS

DEQD0 R9 ;
DEQD0 R10 ;

ADD R0 R0 R0 ; # NOPS
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ; # NOPS

LLW R31 0xFFFF ;
PAUSE SUB R0 R31 R5 ;
B GT PAUSE ;

IK2J_TX_OUTPUT_1 LOAD R31 R3 0x00 ;
AND R0 R31 R5 ;
B EQ IK2J_TX_OUTPUT_1 ;
STORE R9 R2 0x0000 ; # Output 1

ADD R0 R0 R0 ; # NOPS
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ; # NOPS

IK2J_TX_OUTPUT_2 LOAD R31 R3 0x00 ;
AND R0 R31 R5 ;
B EQ IK2J_TX_OUTPUT_2 ;
STORE R10 R2 0x0000 ; # Output 2


ADD R0 R0 R0 ; # NOPS
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ;
ADD R0 R0 R0 ; # NOPS

INFINITE B UNCOND INFINITE ;